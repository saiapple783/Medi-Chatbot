services:
  hospital_neo4j_etl:
    build:
      context: ./hospital_neo4j_etl
    env_file:
      - .env
    platform: linux/amd64
    entrypoint: ["/bin/sh", "/app/entrypoint.sh"]

  chatbot_api:
    build:
      context: ./chatbot_api
    env_file:
      - .env
    depends_on:
      - hospital_neo4j_etl
    ports:
      - "8000:8000"
    platform: linux/amd64
    entrypoint: ["/bin/sh", "/app/src/entrypoint.sh"] 

  chatbot_frontend:
    environment:
    - CHATBOT_URL=http://chatbot_api:8000/hospital-rag-agent
    build:
      context: ./chatbot_frontend
    env_file:
      - .env
    depends_on:
      - chatbot_api
    ports:
      - "8501:8501"
    platform: linux/amd64
    entrypoint: ["/bin/sh", "/app/entrypoint.sh"]
    
  cypher_example_portal:
    build:
      context: ./cypher_example_portal
    env_file:
      - .env
    depends_on:
      - hospital_neo4j_etl
    ports:
      - "8502:8502"
    platform: linux/amd64
    entrypoint: ["/bin/sh", "/app/entrypoint.sh"]